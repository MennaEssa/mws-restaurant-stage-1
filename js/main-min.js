let restaurants,neighborhoods,cuisines;var map,markers=[];function toggleFav(e,t){navigator.onLine?"fav-true"===e.className?DBHelper.updateFav(t,!1).then(()=>{e.classList.toggle("fav-false"),e.className="fav-false",e.setAttribute("aria-label","add restaurant to favorites")}):DBHelper.updateFav(t,!0).then(()=>{e.classList.toggle("fav-true"),e.className="fav-true",e.setAttribute("aria-label","remove restaurant from favorites")}):"fav-true"===e.className?(e.classList.toggle("fav-false"),e.className="fav-false",e.setAttribute("aria-label","add restaurant to favorites"),AddtoSyncFavDB(t,!1)):(e.classList.toggle("fav-true"),e.className="fav-true",e.setAttribute("aria-label","remove restaurant from favorites"),AddtoSyncFavDB(t,!0))}function display_map(){document.getElementById("map-full").style.display="block",document.getElementById("show-map-container").style.display="none"}DBHelper.indexdb_init(),document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,s=t.selectedIndex,r=e[a].value,n=t[s].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,n,(e,t)=>{if(e)console.error(e);else{resetRestaurants(t),fillRestaurantsHTML();new LazyLoad}})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li");let a=document.createElement("button");a.classList.add("fav-true","fav-false"),a.innerHTML="âœª",1==e.is_favorite||"true"==e.is_favorite?(a.className="fav-true",a.setAttribute("aria-label","remove restaurant from favorites")):(a.className="fav-false",a.setAttribute("aria-label","add restaurant to favorites")),a.setAttribute("onclick",`toggleFav(this , ${e.id})`),t.append(a);const s=document.createElement("img");s.className="restaurant-img",s.classList.add("lazy"),s.setAttribute("data-src",`${DBHelper.imageUrlForRestaurant(e)}`),s.alt=DBHelper.altForRestaurant(e),t.append(s);const r=document.createElement("h2");r.innerHTML=e.name,r.id=e.name.replace(/ /g,""),t.append(r);const n=document.createElement("p");n.innerHTML=e.neighborhood,t.append(n);const o=document.createElement("p");o.innerHTML=e.address,o.id=r.id+"_a",t.append(o);const l=document.createElement("a");return l.innerHTML="View Details",l.href=DBHelper.urlForRestaurant(e),l.setAttribute("aria-label","name :"+e.name+",address :"+e.address+", view details"),t.append(l),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})}),navigator.serviceWorker?navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{console.log("[sw] Registered.")}).catch(function(){console.log("[sw] Failed to register")}):console.log("[sw] service not supported , bye."),window.addEventListener("online",doSync);